
define playerSpeed 15
define playerSpeed2 151
define ammoSpeed 20
define ammoXRange 15
define ammoYRange 20
define enemySpeed 10

lo:
    draw.clear 0 0 0
    draw.color 255 255 255 255

    reads :x
    const 10
    reads :x
    addi 10
    const 10
    reads :x
    addi 5
    const 25
    draw.triangle

    reads :ax
    greaterThan 180
    jnei :y
    reads :ax
    sub 3
    reads :ay
    sub 6
    draw.rect 6 12
y:

    draw.color 255 0 0 255

    reads :ex
    reads :ey
    addi 15
    reads :ex
    addi 10
    reads :ey
    addi 15
    reads :ex
    addi 5
    reads :ey
    draw.triangle

    draw.flush

    reads :x
    ini 0
    jeqi :g
    add playerSpeed2
    mod 166
g:
    ini 1
    jeqi :f
    add playerSpeed
    mod 166
f:
    writes :x

    ini 2
    jnei :i

    reads :ay
    add ammoSpeed
    writes :ay
    jmpi :j

i:
    reads :x
    addi 5
    writes :ax
    const 47
    writes :ay

j:
    reads :ey
    cpy
    lessThan 10
    jeqi :c
    sreg $address

    call :gameover 0
    sreg $address

e:
    rand 166
    floor
    writes :ex
    const 161
    writes :ey
    jmpi :d
c:
    sub enemySpeed
    writes :ey
d:

    reads :ax
    reads :ex
    sub
    abs
    greaterThan ammoXRange
    jnei :h

    reads :ay
    reads :ey
    sub
    abs
    greaterThan ammoYRange
    jnei :h

    const 300
    writes :ay

    ini 8
    addi 1
    outi 8

    jmpi :e
h:

    jmpi :lo
    reset

def gameover 0
    draw.clear 255 0 0
    draw.flush
    const 0
    outi 8
    const 100
    sreg $loop
z:
    const 0
    sreg $address
    loop :z
    const 0
    ret

data x 0
data ax 0
data ay 176
data ex 0
data ey 0